<!DOCTYPE html>
<html layout:decorate="~{layout}">
<head>
<meta charset="UTF-8" />
</head>
<body>
	<section layout:fragment="corpo">
		<div class="container"
			style="width: 60%; padding-bottom: 30px; margin-top: 30px;">
			<div class="row">
				<div class="col-sm-6 col-xs-8 mx-auto" id="classePrincipal">
					<th:block th:include="veiculo/mensagemValidacao"></th:block>
				</div>
			</div>
			<div>

				<form method="POST" th:action=@{/veiculos/salvar}
					th:object="${veiculo}" enctype="multipart/form-data">
					<div class="form-group">
						<label for="veiculo">Nome</label> <input type="text"
							class="form-control" placeholder="Nome *" th:field="*{nome}" />
					</div>

					<div class="form-group">
						<label>Tipo(ex:Moto/Carro)</label> <select id="tipo"
							class="form-control">
						</select>
					</div>

					<div class="form-group">
						<label>Marca</label> <select id="marca" class="form-control">
							<option value="">Selecione</option>
						</select>
					</div>

					<input type="hidden" id="tipoMarca" th:field="*{tipoMarca}" />

					<div class="form-group">
						<label>Categoria(ex:NORMAL/VIP)</label> <select id="categoria"
							class="form-control" th:field="*{categoria}">
							<option value="">Selecione</option>
							<option th:each="c : ${categorias}" th:value="${c.id}"
								th:text="${c.nome}"></option>

						</select>
					</div>


					<div class="form-group">
						<label for="placa">Placa</label> <input type="text"
							class="form-control" placeholder="Placa *" th:field="*{placa}" />
					</div>

					<div class="form-group">
						<label for="renavan">Renavan</label> <input type="text"
							class="form-control" placeholder="Renavan *"
							th:field="*{renavan}" />
					</div>
					
					
					<div class="form-group">
						<label>Locadora:</label> <select id="locadora"
							class="form-control" th:field="*{locadora}">
							<option value="">Selecione</option>
							<option th:each="c : ${locadoras}" th:value="${c.id}"
								th:text="${c.nome}"></option>

						</select>
					</div>

					<div class="form-group">
						<p>
							<input id="fileInput" type="file" name="uploadingFiles" multiple>
							selected files: <span id="fileNum">0</span>; total size: <span
								id="fileSize">0</span>
						</p>
					</div>

					<button type="submit" class="btn btn-primary"
						style="margin-top: 10px;" id="btn">Cadastrar</button>
				</form>
			</div>
		</div>
	</section>
</body>

<!-- Placed at the end of the document so the pages load faster -->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"
	integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
	crossorigin="anonymous"></script>
<script type="text/javascript">
	$(document).ready(function() {
		var id;
		jQuery.ajax({
			type : "GET",
			url : "/veiculos/getTipo",
			data : {},
			success : function(dados) {
				$("#tipo").append('<option value="">Selecione</option>');
				for (var i = 0; i < dados.length; i++) {
					$("#tipo").append($('<option>', {
						value : dados[i].id_tipo,
						text : dados[i].nome
					}));
				}
			}
		}).done(function() {

		}).fail(function() {
			console.log("erro ajax");
		});

		$('#tipo').change(function() {
			id = $('#tipo').val();
			$("#marca").empty();
			jQuery.ajax({
				type : "GET",
				url : "/veiculos/getVeiculo/" + id,
				data : {},
				success : function(dados) {
					$("#marca").append('<option value="">Selecione</option>');
					for (var i = 0; i < dados.length; i++) {
						$("#marca").append($('<option>', {
							value : dados[i].id,
							text : dados[i].nome
						}));
					}

				}
			}).done(function() {

			}).fail(function() {
				console.log("erro ajax");
			})

		});

		$('#marca').change(function() {

			var id_marca = $('#marca').val();
			console.log(id);
			console.log(id_marca);
			jQuery.ajax({
				type : "GET",
				url : "/veiculos/getVeiculoMarca/" + id + "&" + id_marca,
				data : {},
				success : function(dados) {

					console.log("id = " + dados.id);
					$('#tipoMarca').val(dados.id);

				}
			}).done(function() {

			}).fail(function() {
				console.log("erro ajax");
			})

		});
	});
</script>
</html>
